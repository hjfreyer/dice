<!DOCTYPE html>
<html>
  <head>
    <script src="bower_components/platform/platform.js"></script>
    <script src="app.js"></script>

    <link rel="import" href="bower_components/polymer/polymer.html">
    <link rel="import" href="bower_components/google-signin/google-signin.html">

    <polymer-element name="x-global" attributes="value">
      <script>
        var value = {};

        Polymer({
          created: function() {
            this.value = value;
          },
          valueChanged: function() { this.value = value; }
        });
      </script>
    </polymer-element>

    <!-- <polymer-element name="google-rpc" attributes="params"> -->
    <!--   <template> -->
    <!--     <x-global value="{{global}}"></x-global> -->
    <!--     <core-ajax id="rpc"></core-ajax> -->
    <!--   </template> -->
    <!--   <script> -->
    <!--     Polymer({ -->

    <!--     }); -->
    <!--   </script> -->
    <!-- </polymer-element> -->

    <!-- <polymer-element name="x-app" params="appIsReady"> -->
    <!--   <template> -->
    <!--     <x-global id="global"></x-global> -->
    <!--     <template if="{{appIsReady}}"> -->
    <!--       <google-signin -->
    <!--          clientId="895593330219-dagqsd3t6aqm8qtvp9t02mkd4aafnkbi.apps.googleusercontent.com" -->
    <!--          scopes="https://www.googleapis.com/auth/drive.file -->
    <!--                  https://www.googleapis.com/auth/drive.install" -->
    <!--          on-google-signin-success="{{signin}}"> -->
    <!--       </google-signin> -->

    <!--       <google-api-loader id="driveLoader" name="drive" -->
    <!--                          version="v2" -->
    <!--                          on-google-api-load="{{foo}}"></google-api-loader> -->

    <!--       <google-api-loader id="pickerLoader" name="picker" -->
    <!--                          version="v1" -->
    <!--                          on-google-api-load="{{foo2}}"></google-api-loader> -->

    <!--       Yo -->


    <!--     </template> -->
    <!--   </template> -->

    <!--   <script> -->
    <!--     Polymer({ -->
    <!--     appIsReady: false, -->
    <!--     signin: function(e) { -->
    <!--     this.auth_token = e.detail.result.access_token; -->
    <!--     }, -->
    <!--     foo: function() { console.log(this.$.driveLoader.api); -->


    <!--     console.log(gapi); -->
    <!--     }, -->
    <!--     foo2: function() { console.log(this.$.pickerLoader.api); } -->
    <!--     }); -->
    <!--   </script> -->
    <!-- </polymer-element> -->
    <polymer-element name="x-app">
      <template>
        <x-global value="{{global}}"></x-global>
        <google-signin
           clientId="895593330219-dagqsd3t6aqm8qtvp9t02mkd4aafnkbi.apps.googleusercontent.com"
           scopes="https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.install"
           on-google-signin-success="{{signIn}}">
        </google-signin>
        <button on-click="{{pick}}">Pick</button>
      </template>
      <script>
        Polymer({
          signIn: function(e) {
            this.global.authToken = e.detail.result.access_token;
            gapi.auth.setToken(this.global.authToken);
          },
          pick: function() {
            createPicker(this.global.authToken);
          }
        });
      </script>
    </polymer-element>

    <polymer-element name="api-loader">
      <template>
        Ready: {{isReady}}
        <template if="{{isReady}}"><x-app></x-app></template>
      </template>
      <script>
        Polymer({
          isReady: false,
          ready: function() {
            gapi.load('picker,drive-realtime', function() {
              this.isReady = true;
            }.bind(this));
          }
        });
      </script>
    </polymer-element>
  </head>
  <body>
    <script type="text/javascript" src="https://apis.google.com/js/api.js"></script>
    <api-loader></api-loader>
    <!-- <script type="text/javascript" src="https://apis.google.com/js/client.js"></script> -->

    <script>
    </script>
  </body>
</html>
